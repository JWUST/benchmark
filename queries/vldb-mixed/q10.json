{
  "priority": 3,
  "operators": {
    "load_vbak" : {
      "type" : "GetTable",
      "name": "vbak_%(sessionId)s"
    },
    "load_vbap" : {
      "type" : "GetTable",
      "name": "vbap_%(sessionId)s"
    },
    "validate_vbap": {
      "type": "ValidatePositions"
    },
    "filter_aedat": {
      "type": "TableScan",
      "expression": "hyrise::Store_FLV_F1_EQ_STRING_AND_F2_GT_INT",
      "f1" : 3,//KUNNR
      "f2" : 2,//ERDAT
      "COMMENT": "from and to values are in the dictionary for 30 million / last 30 days",
      "v_f1" : %(rand_kunnr_vbak)s,
      "v_f2": 20031130,
      "dynamic": true
    },
    "join_header_item": {
      "type": "RadixJoin",
      "comment": "First edge is probe, second edge is hash",
      "bits1": 12,
      "bits2": 5,
      "fields": [1, 1],
      "dynamic": true
    },
    "hash_netwr" : {
      "type": "HashBuild",
      "fields": ["KUNNR"], 
      "key": "groupby"
    },
    "groupby" : {
      "type" : "GroupByScan",
      "fields": ["KUNNR"],
      "functions": [
        {"type": "SUM", "field": "NETWR"}
      ]
    }

  },
  "edges": [
    ["load_vbak", "filter_aedat"], 
    ["load_vbap", "validate_vbap"],
    ["validate_vbap", "join_header_item"],
    ["filter_aedat", "join_header_item"],
    ["join_header_item", "hash_netwr"],
    ["join_header_item", "groupby"],
    ["hash_netwr", "groupby"]
  ]
}

